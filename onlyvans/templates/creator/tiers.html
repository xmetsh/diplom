{% extends 'base.html' %}
{% block title %}Tiers{% endblock %}
{% load crispy_forms_tags %}
{% block content %}
<div class="container main py-5">
    {% include 'messages.html' %}
    <h2>üèÖ –í–∞—à–∏ –ø–æ–¥–ø–∏—Å–∫–∏
        <a class="btn btn-primary" href="{% url 'creator:create-tier' %}">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –ø–æ–¥–ø–∏—Å–∫—É</a>
    </h2>
    <hr>
    <p>
        –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º–∏ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏. –ü–æ–¥–ø–∏—Å–∫–∏ - —ç—Ç–æ —Å–ø–æ—Å–æ–± –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–∞—à–µ–º—É
        –∫–æ–Ω—Ç–µ–Ω—Ç—É. –í—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—É –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è. –ó–∞—Ç–µ–º –≤–∞—à–∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏ –º–æ–≥—É—Ç –≤—ã–±—Ä–∞—Ç—å, –Ω–∞
        –∫–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å –æ–Ω–∏ —Ö–æ—Ç—è—Ç –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è. –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —É –≤–∞—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –±–æ–ª–µ–µ 12 —É—Ä–æ–≤–Ω–µ–π. –ó–¥–µ—Å—å –≤—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ
        —É–≤–∏–¥–µ—Ç—å, –∫—Ç–æ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å.
    </p>
    {% for tier in tiers %}
    <div class="card mb-3">
        {% if tier.id %}
        <div class="card-header d-flex justify-content-between align-items-center">
            <span>
                <h4>{{ tier.name }}</h4>&nbsp;<strong>{{ tier.points_price }}ü™ô<small>–≤ –º–µ—Å—è—Ü</small></strong>
            </span>
            <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteModal"
                data-tier-id="{{ tier.id }}" data-tier-name="{{ tier.name }}"
                data-url-template="{% url 'creator:delete-tier' 0 %}">
                –£–¥–∞–ª–∏—Ç—å
            </button>
        </div>
        <div class="card-body">
            <p>{{ tier.description }}</p>
            <p>–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π: <strong>{{ tier.message_permission|yesno:"‚úîÔ∏è,‚ùå" }}</strong></p>
            <h5>–ü–æ–¥–ø–∏—Å—á–∏–∫–∏ ({{ tier.subscriber_count }}):</h5>
            {% for subscriber in tier.subscribers %}

            <span class="badge text-bg-primary"><a class="text-secondary link-underline link-underline-opacity-0"
                    href="{% url 'profile' subscriber.user.username %}">@{{ subscriber.user.username }} </a></span>

            {% empty %}
            <span>–ï—â–µ –Ω–µ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤.</span>
            {% endfor %}
        </div>
        {% else %}
        <div class="card-header">
            <span>
                <h4>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞</h4>
            </span>
        </div>
        {% endif %}
    </div>
    {% empty %}
    <p>–£ –≤–∞—Å –Ω–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π.</p>
    {% endfor %}
</div>

<!-- Delete Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                –í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É <strong id="tierName"></strong>?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <form method="post" id="deleteForm">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}