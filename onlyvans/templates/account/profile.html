{% extends 'base.html' %}
{% block title %}Profile - {{ user_viewed.username }}{% endblock %}
{% block content %}
{% load static %}
{% load custom_filters %}
<div class="profile-header"
    style="background-image: url('{% if profile and profile.background_pic %}{{ profile.background_pic.url }}{% else %}{% static 'img/background.png' %}{% endif %}');">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="profile-avatar d-flex justify-content-center align-items-center">
                    <img src="{% if profile and profile.profile_pic %}{{ profile.profile_pic.url }}{% else %}{% static 'img/avatar.png' %}{% endif %}"
                        alt="{{ user_viewed.username }}" class="rounded-circle">
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container main py-2">
    {% include 'messages.html' %}
    <div class="profile-info">
        <h1>{{ user_viewed.get_full_name|default:user_viewed.username }}</h1>
        <p>{{ profile.description|default:"–û–ø–∏—Å–∞–Ω–∏–µ, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç " }}</p>
        <div class="social-links mb-3">
            {% if profile and profile.website_url %}
            <a href="{{ profile.website_url }}" class="btn btn-outline-secondary">üåê –°–∞–π—Ç</a>
            {% endif %}
            {% if profile and profile.twitter_url %}
            <a href="{{ profile.twitter_url }}" class="btn btn-outline-secondary">üìΩÔ∏è YouTube</a>
            {% endif %}
            {% if profile and profile.instagram_url %}
            <a href="{{ profile.instagram_url }}" class="btn btn-outline-secondary">üì® VK</a>
            {% endif %}
            {% if profile and not profile.website_url and not profile.twitter_url and not profile.instagram_url %}
            <p>–ù–µ—Ç —Å—Å—ã–ª–æ–∫, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.</p>
            {% endif %}
        </div>
        <p class="mt-3">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: {{ user_viewed.date_joined|date:"F d, Y" }}</p>
        <div class="profile-actions mb-3">
            {% if is_own_profile %}
            <a href="{% url 'update-profile' %}" class="btn btn-primary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
            {% else %}
            {% if user_viewed.is_content_creator and not user.is_content_creator %}
            <a href="{% url 'client:select-tier' user_viewed.username %}" class="btn btn-success">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</a>
            {% endif %}
            {% if can_message %}
            <a href="{% url 'view_thread_with_user' user_viewed.username %}" class="btn btn-secondary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å
                —Å–æ–æ–±—â–µ–Ω–∏–µ</a>
            {% endif %}
            {% endif %}
        </div>
        <div class="profile-stats mb-3">
            {% if user_viewed.is_content_creator %}
            <span>üëÄ –ü–æ–¥–ø–∏—Å—á–∏–∫–∏: {{ active_subscribers_count }}</span>
            <span>üìù –ü—É–±–ª–∏–∫–∞—Ü–∏–π: {{ user_viewed.user_posts.count }}</span>
            <span>üìà –£—Ä–æ–≤–Ω–∏ –ø–æ–¥–ø–∏—Å–æ–∫: {{ user_viewed.tiers.count }}</span>
            <span>üëç –ù—Ä–∞–≤–∏—Ç—Å—è: {{ total_likes }}</span>
            {% else %}
            <span>üí∏ –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫: {{ total_subscriptions }}</span>
            <span>‚ù§Ô∏è –û—Ç–º–µ—Ç–æ–∫ –Ω—Ä–∞–≤–∏—Ç—Å—è: {{ total_likes_given }}</span>
            {% endif %}
        </div>
    </div>

    {% if user_viewed.is_content_creator %}
    <div class="row">
        <div class="col-md-12">
            <h2>–ü—É–±–ª–∏–∫–∞—Ü–∏–∏ @{{ user_viewed.username }}</h2>
            {% include 'creator/feed.html' with posts=posts show_visibility=True %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}